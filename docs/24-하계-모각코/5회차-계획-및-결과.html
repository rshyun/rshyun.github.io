<!DOCTYPE html> <html><head>
		<title>5회차 계획 및 결과</title>
		<base href="../">
		<meta id="root-path" root-path="../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="RSHYUN.GITHUB.IO - 5회차 계획 및 결과">
		<meta property="og:title" content="5회차 계획 및 결과">
		<meta property="og:description" content="RSHYUN.GITHUB.IO - 5회차 계획 및 결과">
		<meta property="og:type" content="website">
		<meta property="og:url" content="24-하계-모각코/5회차-계획-및-결과.html">
		<meta property="og:image" content="lib\media\5회차1.png">
		<meta property="og:site_name" content="RSHYUN.GITHUB.IO">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon mk-readable-line mk-folder-lines mk-spaces-enabled mk-inline-context-enabled mk-flow-seamless"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..." style="border-radius:10px; border-width: 0px;"><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="5회차 계획 및 결과"><p dir="auto">5회차 계획 및 결과</p></h1><div class="heading-wrapper"><h2 data-heading="계획" dir="auto" class="heading" id="계획"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>계획</h2><div class="heading-children"><div><blockquote dir="auto">
<p>날짜 : 2024.08.05 14:00 - 17:00<br>
목표 : 모델 학습 방법 숙달<br>
계획 : GAN 모델로 이미지 생성 모델 실습</p>
</blockquote></div></div></div><div class="heading-wrapper"><h2 data-heading="결과" dir="auto" class="heading" id="결과"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>결과</h2><div class="heading-children"><div class="heading-wrapper"><h3 data-heading="1. GAN" dir="auto" class="heading" id="1._GAN"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1. GAN</h3><div class="heading-children"><div class="heading-wrapper"><h4 data-heading="1 - 1. 개념" dir="auto" class="heading" id="1_-_1._개념"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1 - 1. 개념</h4><div class="heading-children"><div><ul>
<li data-line="0" dir="auto">GAN(Generative Adversarial Networks) 은 적대적 생성 신경망이라고 불리며, 실제에 가까운 이미지나 사람이 쓴 것과 같은 글 등 여러 가짜 데이터들을 생성하는 딥러닝 기반 모델.</li>
<li data-line="1" dir="auto">서로 다른 2개의 네트워크인 생성모델 (Generator) 과 판별모델 (Discriminator) 을 적대적으로 학습시키며 실제 데이터와 비슷한 데이터를 생성해내는 모델.</li>
<li data-line="2" dir="auto">생성된 데이터에 정해진 레이블 값이 없기 때문에 비지도 학습 기반 생성 모델로 분류됨.</li>
<li data-line="3" dir="auto">생성 모델의 목적은 진짜 분포에 가까운 가짜 분포를 생성하는 것이고, 판별 모델의 목적은 표본이 가짜 분포에 속하는지 진짜 분포에 속하는지를 결정하는 것임.</li>
<li data-line="4" dir="auto">GAN 의 궁극적인 목적은 실제 데이터의 분포에 가까운 가까 데이터를 생성하는 것이따라서 판별 모델이 진짜인지 가짜인지를 한쪽으로 판단하지 못하는 경계, 즉 가짜와 진짜를 0과 1로 보았을 때 0.5 값의 위치에서 가짜 와 진짜를 구별할 수 없는 최적해로 간주하게 됨.</li>
</ul></div></div></div><div class="heading-wrapper"><h4 data-heading="1 - 2. 모델 구조" dir="auto" class="heading" id="1_-_2._모델_구조"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1 - 2. 모델 구조</h4><div class="heading-children"><div><p dir="auto"><span alt="5회차1.png" src="5회차1.png" class="internal-embed media-embed image-embed is-loaded"><img alt="5회차1.png" src="lib/media/5회차1.png"></span></p></div><div><p dir="auto"><em>(출처 : Hamed Alqahtani. 2019. An Analysis Of Evaluation Metric Of GANs)</em></p></div><div><ul>
<li data-line="0" dir="auto">생성 모델 (G) 는 실제 데이터와 비슷한 데이터를 만들어내도록 학습되며, 판별 모델 (D) 는 실제 데이터와 생성 모델이 생성한 가짜 데이터를 구별하도록 학습됨.</li>
<li data-line="1" dir="auto">GAN 의 목적 함수는 게임 이론 타입의 목적 함수로 G, D 2명의 플레이어가 싸우면서 서로 균형점을 찾아가도록 하는 방식임.</li>
</ul></div><div><p dir="auto"><span alt="5회차2.png" src="5회차2.png" class="internal-embed media-embed image-embed is-loaded"><img alt="5회차2.png" src="lib/media/5회차2.png"></span></p></div><div><ul>
<li data-line="0" dir="auto">여기서 V(D,G) 의 값은 확률값으로 도출됨.</li>
<li data-line="1" dir="auto">이 수식을 D 의 관점에서 살펴보면 실제 데이터 x를 입력하면 D(x) 가 커지면서 log 값이 커져 높은 확률값이 나오도록 하고, 가짜 데이터 G(z) 를 입력하면 log 값이 작아짐에 따라 낮은 확률값이 나오도록 학습됨. 즉 실제 데이터와 G 가 만든 가짜 데이터를 잘 구분하도록 조금씩 업데이트되는 것.</li>
<li data-line="2" dir="auto">이 수식을 G 의 관점에서 살펴보면 Zero-Mean Gaussian 분포에서 노이즈 z 를 멀레이어 퍼셉트론에 통과시켜 샘플들을 생성하며 이 생성된 가짜 데이터 G(z) 를 D 에 입력했을 때 실제 데이터처럼 확률이 높게 나오도록 학습됨. D(G(z)) 값이 높아지고 전체 확률값이 낮아지도록, 즉 G 가 D가 잘 구분하지 못하는 데이터를 생성하도록 조금씩 업데이트되는 것.</li>
<li data-line="3" dir="auto">실제 학습을 진행할 때 2개의 네트워크를 동시에 학습시키지 않고 하나의 네트워크를 고정한 상태에서 다른 한 네트워크를 업데이트하는 방식으로 따로따로 업데이트함.</li>
</ul></div></div></div></div></div><div class="heading-wrapper"><h3 data-heading="2. 이미지 데이터셋을 활용하여 실습" dir="auto" class="heading" id="2._이미지_데이터셋을_활용하여_실습"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2. 이미지 데이터셋을 활용하여 실습</h3><div class="heading-children"><div class="heading-wrapper"><h4 data-heading="2 - 1. 라이브러리 import" dir="auto" class="heading" id="2_-_1._라이브러리_import"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2 - 1. 라이브러리 import</h4><div class="heading-children"><div><pre><code>import torch
from torchvision import datasets, transforms
from torch.utils.data import DataLoader
from torchvision import datasets, transforms
from torch.utils.data import DataLoader
from torch.utils.data import Subset
import torch
import torch.nn as nn
import torch.optim as optim
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="2 - 2. 데이터셋 파일 불러오기" dir="auto" class="heading" id="2_-_2._데이터셋_파일_불러오기"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2 - 2. 데이터셋 파일 불러오기</h4><div class="heading-children"><div><pre><code># 필요한 라이브러리 import
import os
import zipfile

# 파일 다운로드
!wget https://daiv-cnu.duckdns.org/contest/ai_competition[2024]_basic/dataset/datasets.zip -O /content/datasets.zip

# 압축 파일 경로
zip_file_path = "/content/datasets.zip"

# 압축 풀 위치
extract_folder = "/content/datasets"

# 압축 파일 풀기
with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:
&nbsp; &nbsp; zip_ref.extractall(extract_folder)

# 압축이 풀린 디렉터리의 내용 확인
print("압축이 풀린 디렉터리 내용:")
os.listdir(extract_folder)
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="2 - 3. 데이터 전처리" dir="auto" class="heading" id="2_-_3._데이터_전처리"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2 - 3. 데이터 전처리</h4><div class="heading-children"><div><pre><code># 데이터 전처리
transform = transforms.Compose([
&nbsp; &nbsp; transforms.Resize((64, 64)),
&nbsp; &nbsp; transforms.ToTensor(),
&nbsp; &nbsp; transforms.Normalize(mean=[0.5, 0.5, 0.5], std=[0.5, 0.5, 0.5])
])

# 데이터셋 경로
dataset_dir = "/content/datasets"

# 데이터셋 생성
dataset = datasets.ImageFolder(root=dataset_dir, transform=transform)

# 이미지 폴더 경로 설정 (상위폴더)
data_dir = "/content/datasets/valid"

# ImageFolder 데이터셋 생성
dataset = datasets.ImageFolder(root=data_dir, transform=transform)

# 클래스 이름 확인
class_names = dataset.classes
print("클래스 이름:", class_names)
</code><button class="copy-code-button">복사</button></pre></div><div><pre><code># 원하는 클래스 이름
target_classes = ['Egg'] 

# 선택한 클래스의 인덱스 가져오기
target_indices = [class_names.index(cls) for cls in target_classes]

# 선택한 클래스의 인덱스를 가지는 데이터만 필터링
selected_indices = [i for i, (_, label) in enumerate(dataset) if label in target_indices]

# 서브셋 생성
subset = Subset(dataset, selected_indices)

# 데이터 로더 설정
dataloader = DataLoader(subset, batch_size=32, shuffle=True)

# 데이터셋 샘플 확인
for images, labels in dataloader:
&nbsp; &nbsp; print("이미지 크기:", images.size())
&nbsp; &nbsp; print("레이블:", labels)
&nbsp; &nbsp; break
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="2 - 4. 생성모델" dir="auto" class="heading" id="2_-_4._생성모델"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2 - 4. 생성모델</h4><div class="heading-children"><div><pre><code>class Generator(nn.Module):
&nbsp; &nbsp; def __init__(self, noise_dim, num_classes, img_size):
&nbsp; &nbsp; &nbsp; &nbsp; super(Generator, self).__init__()
&nbsp; &nbsp; &nbsp; &nbsp; self.label_emb = nn.Embedding(num_classes, noise_dim)
&nbsp; &nbsp; &nbsp; &nbsp; self.model = nn.Sequential(
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Linear(noise_dim * 2, 128),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.ReLU(inplace=True),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Linear(128, 256),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.BatchNorm1d(256),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.ReLU(inplace=True),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Linear(256, 512),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.BatchNorm1d(512),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.ReLU(inplace=True),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Linear(512, img_size * img_size * 3),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Tanh()
&nbsp; &nbsp; &nbsp; &nbsp; )
&nbsp; &nbsp; &nbsp; &nbsp; self.img_size = img_size

&nbsp; &nbsp; def forward(self, noise, labels):
&nbsp; &nbsp; &nbsp; &nbsp; label_embedding = self.label_emb(labels)
&nbsp; &nbsp; &nbsp; &nbsp; x = torch.cat((noise, label_embedding), dim=1)
&nbsp; &nbsp; &nbsp; &nbsp; img = self.model(x)
&nbsp; &nbsp; &nbsp; &nbsp; img = img.view(img.size(0), 3, self.img_size, self.img_size)
&nbsp; &nbsp; &nbsp; &nbsp; return img
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="2 - 5. 판별모델" dir="auto" class="heading" id="2_-_5._판별모델"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2 - 5. 판별모델</h4><div class="heading-children"><div><pre><code>class Discriminator(nn.Module):
&nbsp; &nbsp; def __init__(self, num_classes, img_size):
&nbsp; &nbsp; &nbsp; &nbsp; super(Discriminator, self).__init__()
&nbsp; &nbsp; &nbsp; &nbsp; self.label_embedding = nn.Embedding(num_classes, img_size * img_size * 3)
&nbsp; &nbsp; &nbsp; &nbsp; self.model = nn.Sequential(
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Linear(img_size * img_size * 3 * 2, 512),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.LeakyReLU(0.2, inplace=True),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Linear(512, 256),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.LeakyReLU(0.2, inplace=True),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Linear(256, 128),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.LeakyReLU(0.2, inplace=True),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Linear(128, 1),
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nn.Sigmoid()
&nbsp; &nbsp; &nbsp; &nbsp; )

&nbsp; &nbsp; def forward(self, img, labels):
&nbsp; &nbsp; &nbsp; &nbsp; label_embedding = self.label_embedding(labels)
&nbsp; &nbsp; &nbsp; &nbsp; label_embedding = label_embedding.view(label_embedding.size(0), -1)
&nbsp; &nbsp; &nbsp; &nbsp; img_flat = img.view(img.size(0), -1)
&nbsp; &nbsp; &nbsp; &nbsp; x = torch.cat((img_flat, label_embedding), dim=1)
&nbsp; &nbsp; &nbsp; &nbsp; validity = self.model(x)
&nbsp; &nbsp; &nbsp; &nbsp; return validity
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="2 - 6. 최적화 설정" dir="auto" class="heading" id="2_-_6._최적화_설정"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2 - 6. 최적화 설정</h4><div class="heading-children"><div><pre><code># 하이퍼파라미터 설정

noise_dim = 100
num_classes = len(class_names)
img_size = 64
batch_size = 32
lr = 0.0002
num_epochs = 500
</code><button class="copy-code-button">복사</button></pre></div><div><pre><code># 모델 초기화

generator = Generator(noise_dim, num_classes, img_size).to(device)
discriminator = Discriminator(num_classes, img_size).to(device)
</code><button class="copy-code-button">복사</button></pre></div><div><pre><code># 손실 함수 및 옵티마이저 설정

adversarial_loss = nn.BCELoss()
optimizer_G = optim.Adam(generator.parameters(), lr=lr, betas=(0.5, 0.999))
optimizer_D = optim.Adam(discriminator.parameters(), lr=lr, betas=(0.5, 0.999))
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="2 - 7. 학습" dir="auto" class="heading" id="2_-_7._학습"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2 - 7. 학습</h4><div class="heading-children"><div><pre><code># 학습 루프

for epoch in range(num_epochs):
&nbsp; &nbsp; for i, (real_images, labels) in enumerate(dataloader):
&nbsp; &nbsp; &nbsp; &nbsp; batch_size = real_images.size(0)
&nbsp; &nbsp; &nbsp; &nbsp; real_images = real_images.to(device)
&nbsp; &nbsp; &nbsp; &nbsp; labels = labels.to(device)

&nbsp; &nbsp; &nbsp; &nbsp; # 판별자 학습
&nbsp; &nbsp; &nbsp; &nbsp; optimizer_D.zero_grad()
&nbsp; &nbsp; &nbsp; &nbsp; real_labels = torch.ones(batch_size, 1).to(device)
&nbsp; &nbsp; &nbsp; &nbsp; fake_labels = torch.zeros(batch_size, 1).to(device)

&nbsp; &nbsp; &nbsp; &nbsp; # 진짜 이미지 학습
&nbsp; &nbsp; &nbsp; &nbsp; outputs = discriminator(real_images, labels)
&nbsp; &nbsp; &nbsp; &nbsp; d_loss_real = adversarial_loss(outputs, real_labels)

&nbsp; &nbsp; &nbsp; &nbsp; # 가짜 이미지 학습
&nbsp; &nbsp; &nbsp; &nbsp; noise = torch.randn(batch_size, noise_dim).to(device)
&nbsp; &nbsp; &nbsp; &nbsp; generated_labels = torch.randint(0, num_classes, (batch_size,)).to(device)
&nbsp; &nbsp; &nbsp; &nbsp; fake_images = generator(noise, generated_labels)
&nbsp; &nbsp; &nbsp; &nbsp; outputs = discriminator(fake_images.detach(), generated_labels)
&nbsp; &nbsp; &nbsp; &nbsp; d_loss_fake = adversarial_loss(outputs, fake_labels)

&nbsp; &nbsp; &nbsp; &nbsp; # 총 판별자 손실
&nbsp; &nbsp; &nbsp; &nbsp; d_loss = d_loss_real + d_loss_fake
&nbsp; &nbsp; &nbsp; &nbsp; d_loss.backward()
&nbsp; &nbsp; &nbsp; &nbsp; optimizer_D.step()

&nbsp; &nbsp; &nbsp; &nbsp; # 생성자 학습
&nbsp; &nbsp; &nbsp; &nbsp; optimizer_G.zero_grad()
&nbsp; &nbsp; &nbsp; &nbsp; outputs = discriminator(fake_images, generated_labels)
&nbsp; &nbsp; &nbsp; &nbsp; g_loss = adversarial_loss(outputs, real_labels)
&nbsp; &nbsp; &nbsp; &nbsp; g_loss.backward()
&nbsp; &nbsp; &nbsp; &nbsp; optimizer_G.step()

&nbsp; &nbsp; &nbsp; &nbsp; if i % 100 == 0:
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print(f"Epoch [{epoch+1}/{num_epochs}], Step [{i+1}/{len(dataloader)}], "
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f"D Loss: {d_loss.item()}, G Loss: {g_loss.item()}")
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="2 - 8. 생성된 이미지 시각화" dir="auto" class="heading" id="2_-_8._생성된_이미지_시각화"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2 - 8. 생성된 이미지 시각화</h4><div class="heading-children"><div><pre><code>import matplotlib.pyplot as plt
import numpy as np
import torchvision
</code><button class="copy-code-button">복사</button></pre></div><div><pre><code># 생성된 이미지 시각화

generator.eval()
with torch.no_grad():
&nbsp; &nbsp; noise = torch.randn(16, noise_dim).to(device)
&nbsp; &nbsp; sample_labels = torch.tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5]).to(device) &nbsp;# 예시 레이블
&nbsp; &nbsp; generated_images = generator(noise, sample_labels).cpu()
&nbsp; &nbsp; generated_images = generated_images * 0.5 + 0.5 &nbsp;# 정규화 해제
&nbsp; &nbsp; grid_img = np.transpose(torchvision.utils.make_grid(generated_images, nrow=4), (1, 2, 0))

plt.figure(figsize=(8, 8))
plt.imshow(grid_img)
plt.axis('off')
plt.show()
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto"><span alt="생성결과물.png" src="생성결과물.png" class="internal-embed media-embed image-embed is-loaded"><img alt="생성결과물.png" src="lib/media/생성결과물.png"></span></p></div><div><p dir="auto"><em>위 코드를 학습 시킨 후 생성된 결과물.</em></p></div><div><p dir="auto"><a data-tooltip-position="top" aria-label="https://colab.research.google.com/drive/1YBLarKOzyMRdLmkkanHMwbgj040KDZsJ?usp=sharing" rel="noopener" class="external-link" href="https://colab.research.google.com/drive/1YBLarKOzyMRdLmkkanHMwbgj040KDZsJ?usp=sharing" target="_blank"><em>colab 링크</em></a></p></div><div class="mod-footer"></div></div></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#5회차 계획 및 결과"><div class="tree-item-contents heading-link" heading-name="5회차 계획 및 결과"><span class="tree-item-title">5회차 계획 및 결과</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#계획"><div class="tree-item-contents heading-link" heading-name="계획"><span class="tree-item-title">계획</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#결과"><div class="tree-item-contents heading-link" heading-name="결과"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">결과</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#1._GAN"><div class="tree-item-contents heading-link" heading-name="1. GAN"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">1. 
GAN
</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#1_-_1._개념"><div class="tree-item-contents heading-link" heading-name="1 - 1. 개념"><span class="tree-item-title">1 - 1. 개념</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#1_-_2._모델_구조"><div class="tree-item-contents heading-link" heading-name="1 - 2. 모델 구조"><span class="tree-item-title">1 - 2. 모델 구조</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#2._이미지_데이터셋을_활용하여_실습"><div class="tree-item-contents heading-link" heading-name="2. 이미지 데이터셋을 활용하여 실습"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">2. 
이미지 데이터셋을 활용하여 실습
</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#2_-_1._라이브러리_import"><div class="tree-item-contents heading-link" heading-name="2 - 1. 라이브러리 import"><span class="tree-item-title">2 - 1. 라이브러리 import</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#2_-_2._데이터셋_파일_불러오기"><div class="tree-item-contents heading-link" heading-name="2 - 2. 데이터셋 파일 불러오기"><span class="tree-item-title">2 - 2. 데이터셋 파일 불러오기</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#2_-_3._데이터_전처리"><div class="tree-item-contents heading-link" heading-name="2 - 3. 데이터 전처리"><span class="tree-item-title">2 - 3. 데이터 전처리</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#2_-_4._생성모델"><div class="tree-item-contents heading-link" heading-name="2 - 4. 생성모델"><span class="tree-item-title">2 - 4. 생성모델</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#2_-_5._판별모델"><div class="tree-item-contents heading-link" heading-name="2 - 5. 판별모델"><span class="tree-item-title">2 - 5. 판별모델</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#2_-_6._최적화_설정"><div class="tree-item-contents heading-link" heading-name="2 - 6. 최적화 설정"><span class="tree-item-title">2 - 6. 최적화 설정</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#2_-_7._학습"><div class="tree-item-contents heading-link" heading-name="2 - 7. 학습"><span class="tree-item-title">2 - 7. 학습</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="24-하계-모각코\5회차-계획-및-결과.html#2_-_8._생성된_이미지_시각화"><div class="tree-item-contents heading-link" heading-name="2 - 8. 생성된 이미지 시각화"><span class="tree-item-title">2 - 8. 생성된 이미지 시각화</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>